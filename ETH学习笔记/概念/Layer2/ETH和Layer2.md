视频资源

- 【北京大学Web3公开课】系统学习区块链、以太坊和智能合约
    - https://www.bilibili.com/video/BV1YM411J7oS?spm_id_from=333.788.videopod.episodes&vd_source=9e7f96609fdf67741d9bbf68913badca&p=3



以下是关于 ETH 拥堵问题、Layer 2 解决方案及相关技术和项目的完整笔记整理和补充：

---

### **1. 为什么 ETH 会拥堵？**

以太坊（ETH）是一个高度去中心化的公共区块链平台，用户可以在其上部署智能合约，并使用去中心化应用（DApp）。然而，由于以下原因，以太坊网络过去经常面临**拥堵**问题：

#### **1.1 网络资源有限，应用需求高**
- **以太坊的交易处理能力：**
  以太坊的设计限制了每秒交易处理量（TPS，约为 15-30 笔交易/秒），这与现实世界中数万笔交易/秒的需求相距甚远。
- **Gas机制：**
  每个交易、智能合约操作或运行 DApp 都需要消耗 Gas，而 Gas 是有限的资源。在交易需求增长时，Gas 价格急剧上升。
- **竞争资源：**
  用户需要为交易支付更高的交易费（Gas 费），以抢占有限的区块空间，这进一步放大了拥堵问题。

#### **1.2 DeFi 和 DEX 的兴起**
去中心化金融（DeFi）和去中心化交易所（DEX）是以太坊上最活跃的应用场景，它们的繁荣增加了网络的拥堵：
- **DeFi 的特点：**
  去中心化借贷、质押、流动性挖矿和衍生品交易需要多重复杂的合约调用。
- **DEX：**
  像 Uniswap 等去中心化交易所需要执行频繁的小额交易，这对以太坊的处理能力构成了巨大压力。
- **影响：**
  在高峰期单笔交易的手续费可以飙升至几十甚至上百美元，令普通用户望而却步。

#### **1.3 NFT 的火热**
NFT 项目的涌入也加剧了以太坊的资源竞争：
- **NFT 铸造（Minting）、交易：**
  针对热门 NFT 项目的抢购（如 CryptoPunks、BAYC）和大规模交易进一步占用链上资源。
- **NFT 市场：**
  如 OpenSea 的繁荣也导致大量智能合约操作，增加网络负荷。

---

### **2. 什么是 Layer 2？**

Layer 2 是在以太坊区块链（Layer 1）之上构建的扩展解决方案，用于**缓解以太坊主链的负担**，实现更高效、更低成本的操作，同时保持一定的安全性。

#### **2.1 Layer 2 的基本原理**
Layer 2 的核心思想是将大部分计算和交易量移到链下处理，仅将必要的验证信息提交到以太坊主链。这种设计通过减少以太坊主网的工作量，实现以下目标：
- **减少网络负载：** 主链只需要处理已经简化过的交易数据。
- **降低成本：** 用户的交易手续费比主网费用低得多。
- **提升 TPS：** 一次性可以处理海量用户的交互和数据。

#### **2.2 Layer 2 的必要特性**
Layer 2 解决方案通常需要满足以下特性：
1. **继承 Layer 1 的安全性：**
   Layer 2 不依赖自己的独立安全机制，而是利用以太坊主链的共识和数据保存能力，确保交易数据的安全性和完整性。
2. **链上最终性：**
   Layer 2 操作最终会同步到 Layer 1，以确保主网和链下处理结果一致。

---

### **3. 为什么侧链不属于 Layer 2？**

侧链（Sidechain）是区块链生态一种常见的扩展方法，它是一个**独立的区块链**，可以与以太坊等主链进行交互。然而，与 Layer 2 的关键差别在于：

#### **3.1 侧链的关键特点**
- **独立性：**
  侧链有自己的共识机制（如 PoS 或 PoA），独立于以太坊的主链，主链和侧链的安全性没有直接关联。
- **中心化风险：**
  侧链的安全性和分布式程度通常低于主链。如果侧链被攻击或验证节点作恶，既无法依靠以太坊主链保障，也无法追溯。

#### **3.2 为什么不算 Layer 2？**
- Layer 2 的核心是**依赖以太坊主链的安全性**，而侧链实际上是一个独立于主链的区块链。因此，侧链不能算作 Layer 2。
- 常见的侧链：Polygon（Matic Network）

---

### **4. Layer 2 的解决方案**

#### **4.1 Rollup**
Rollup 是目前最主流的 Layer 2 解决方案，它通过将大部分交易和计算转移到链下，在链上存储和验证**压缩后的交易数据**。

---

#### **A. zk-Rollups**
- **原理：**
  zk-Rollups（零知识汇总）通过零知识证明技术，将链下的交易数据压缩并生成数学证明（即 zk-SNARK 或 zk-STARK 提供的证明），证明这些交易的合法性并提交到主链。
- **特点：**
  1. **无需挑战期（Challenge Period）：**
     zk-Rollups 通过密码学验证交易的有效性，而不依赖社区质疑。
  2. **高效和即时性：**
     zk-Rollups 提交的结果几乎即时生效。
  3. **高度安全：**
     交易的正确性依赖于密码学保证，不依赖第三方。
- **缺点：**
  1. **计算复杂度高：**
     zk-Rollups 的证明生成（由 zk-SNARK 或 zk-STARK 提供支持）对于证明者来说非常耗费计算资源。
  2. **开发门槛：**
     zk 技术复杂，支持零知识证明的编程工具链还在快速发展中。

- **应用：**
  1. ZkSync
  2. StarkWare（StarkEx、StarkNet）
  3. dYdX、Immutable X 等项目。

---

#### **B. Optimistic Rollups**
- **原理：**
  Optimistic Rollups 在提交链下交易结果时，假设所有交易默认是有效的（Optimistic，即“乐观”），并且通过一段时间的质押和挑战过程来验证合法性。
- **特点：**
  1. **易于开发：**
     相较 zk-Rollups 更容易实现，也更容易与现有的以太坊智能合约兼容。
  2. **低计算压力：**
     验证不依赖密码学，只需质押与挑战即可完成。
- **缺点：**
  1. **挑战期长：**
     通常需要 1-2 周的挑战期，用户无法快速提现资金，带来了用户体验不佳的问题。
  2. **依赖挑战者网络：**
     需要社区中存在足够多的“挑战者”来验证和举报恶意交易。

- **应用：**
  1. Arbitrum
  2. Optimism

---

### **5. zk-SNARK 和 zk-STARK 比较**

零知识证明技术用于 zk-Rollups 的核心，主要有两种方式：

| **特性**        | **zk-SNARK**                      | **zk-STARK**               |
|----------------|----------------------------------|---------------------------|
| **全称**        | Zero-Knowledge Succinct Non-Interactive Argument of Knowledge | Zero-Knowledge Scalable Transparent ARgument of Knowledge |
| **交互性**      | 非交互性                           | 非交互性                   |
| **证明大小**     | 小，证明生成速度快                     | 较大，但更可扩展              |
| **透明性**      | 需要可信设置（Trust Setup）             | 不需要可信设置，避免信任问题     |
| **抗量子攻击**   | 对量子计算机相对脆弱                   | 天生具有抗量子攻击能力          |
| **应用场景**     | Zcash、Filecoin 等                  | StarkWare、zkSync 等        |

---

### **6. 常见 Layer 2 项目**

| **项目名称** | **类型**        | **特点**                                                                         |
|-------------|----------------|---------------------------------------------------------------------------------|
| **Arbitrum** | Optimistic Rollups | 高以太坊兼容性，优化挑战期问题，已成最大 Rollup 项目之一                                 |
| **Optimism** | Optimistic Rollups | 简单易用，支持 DeFi 项目，重点提升开发者友好性                                           |
| **zkSync**   | zk-Rollups      | 支持零知识证明，高效和安全，但证明生成计算复杂，适合高效支付场景                                |
| **StarkWare**| zk-Rollups      | 使用 zk-STARK 技术，无需可信设置，已被 DeFi 项目 dYdX 和 Immutable X 广泛采用             |
| **Polygon（Matic）** | 侧链          | 扩展 SideChain 并支持 Layer 2 解决方案，旨在同时提升以太坊扩展性和独立性                  |

---

### **7. 总结**

- **为什么以太坊拥堵？**
  DeFi、DEX 和 NFT 使用量高，导致以太坊资源紧张，Gas 费高居不下。
- **Layer 2 如何解决问题？**
  Layer 2 在链下处理大部分计算，将简化数据提交至主链，降低主链负担。
- **主要解决方案：**
  - zk-Rollups：依赖密码学的零知识证明，无需挑战期，高效但计算复杂。
  - Optimistic Rollups：假设默认交易正确，通过挑战期验证，兼容性高但挑战期过长。
- **Layer 2 的发展前景：**
  zk-Rollups 被认为是未来扩展的关键，但目前开发门槛较高。Optimistic Rollups 则在短期内更易落地。

结合以太坊 2.0 和 Layer 2 技术的快速发展，未来以太坊的扩展性和用户体验将大幅提升。